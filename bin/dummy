#!/bin/sh
#
# wrapper sub-script to run security tool
#
# * created: 2012-02-05 Kevin Chan <kefin@makedostudio.com>
# * updated: 2012-02-11 kchan

########################################################################
myname=`basename $0`
OLD_PWD=$PWD
cd "`dirname $0`"
mydir="${PWD%/}"
cd "$OLD_PWD"
########################################################################

# load configurations and helper functions

BASE_DIR="$(dirname $mydir)"
CONFIG="$BASE_DIR/conf/run_audit.conf"
UTILS="$BASE_DIR/bin/utils"

. "$CONFIG"
. "$UTILS"

check_root_user

# run dummy audit

tmpfile=$(mktemp -q "/tmp/${myname}.XXXXXX")
[ $? -ne 0 ] && error "Can't create temp file, exiting..."
touch "$tmpfile"
cleanup()
{
    rm -f $tmpfile
}
trap "cleanup" EXIT


echo "LOG_DIR: $LOG_DIR"
echo "EMAIL: $EMAIL"

subject="test"
echo "this is a test" > "$tmpfile"
notify "$EMAIL" "$(date '+%Y-%m-%d') $subject" "$tmpfile"

